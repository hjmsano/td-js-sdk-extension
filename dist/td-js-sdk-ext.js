!function(e){var t={};function n(o){if(t[o])return t[o].exports;var i=t[o]={i:o,l:!1,exports:{}};return e[o].call(i.exports,i,i.exports,n),i.l=!0,i.exports}n.m=e,n.c=t,n.d=function(e,t,o){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(n.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)n.d(o,i,function(t){return e[t]}.bind(null,i));return o},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=0)}([function(e,t,n){"use strict";function o(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}n.r(t);var i={},r=0,a=function(){function e(t){var n,o;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e);try{n=new CustomEvent(t.eventName)}catch(e){(n=window[t.targetWindow].document.createEvent("CustomEvent")).initCustomEvent(t.eventName,!1,!1,{})}window[t.targetWindow].requestAnimationFrame=window[t.targetWindow].requestAnimationFrame||window[t.targetWindow].mozRequestAnimationFrame||window[t.targetWindow].webkitRequestAnimationFrame,function e(){if(window[t.targetWindow].requestAnimationFrame(e),o)return!1;o=setTimeout(function(){window[t.targetWindow].dispatchEvent(n),o=null},t.eventFrequency)}()}var t,n,a;return t=e,(n=[{key:"addListener",value:function(e,t,n,o){return e.addEventListener(t,n,o),i[r]={element:e,type:t,listener:n,capture:o},r++}},{key:"removeListener",value:function(e){if(e in i){var t=i[e];t.element.removeEventListener(t.type,t.listener,t.capture)}}}])&&o(t.prototype,n),a&&o(t,a),e}();function d(e){return(d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function c(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}var l=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,o;return t=e,(n=[{key:"generateId",value:function(){for(var e=(+new Date).toString(36),t="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789",n="",o=0;o<32;o++)n+=t[Math.floor(Math.random()*t.length)];return"".concat(e,"-").concat(n)}},{key:"mergeObj",value:function(e){for(var t={},n=0;n<e.length;n++)for(var o in e[n])"object"!==d(e[n][o])||null===e[n][o]||Array.isArray(e[n][o])?Array.isArray(e[n][o])?t[o]=t[o]?t[o].concat(e[n][o]):e[n][o]:t[o]=e[n][o]:t[o]=t[o]?this.mergeObj([t[o],e[n][o]]):e[n][o];return t}},{key:"getPerformanceInfo",value:function(){var e=window.performance.timing,t=e.domInteractive-e.domLoading,n=e.domContentLoadedEventStart-e.domLoading,o=e.domComplete-e.domLoading;return{performance_interactive:t>=0?t:void 0,performance_dcl:n>=0?n:void 0,performance_complete:o>=0?o:void 0}}},{key:"getMediaInfo",value:function(e){return!!e&&{media_src:e.src,media_type:e.type||void 0,media_width:e.clientWidth||void 0,media_height:e.clientHeight||void 0,media_current_time:Math.round(10*e.currentTime)/10,media_duration:Math.round(10*e.duration)/10,media_played_percent:Math.round(e.currentTime/e.duration*1e3)/10,media_player_id:e.playerId||void 0,media_muted:e.muted||!1,media_default_muted:e.defaultMuted||!1,media_autoplay:e.autoplay||!1,media_attr:e.dataset?JSON.stringify(e.dataset):void 0}}},{key:"getVisibility",value:function(e,t){var n=0,o={};try{o=e.getBoundingClientRect(),n=e.innerText.length}catch(e){o={}}var i=window[t].innerHeight,r=window[t].document.documentElement.scrollHeight,a=window[t].document.visibilityState||"unknown",d="pageYOffset"in window[t]?window[t].pageYOffset:(window[t].document.documentElement||window[t].document.body.parentNode||window[t].document.body).scrollTop,c=d+i,l=o.height,u=o.top<=0?0:o.top,s=-1*(o.bottom-i)<=0?0:-1*(o.bottom-i),m=c,f=c/r,p=null,v=null,g=!1;return o.top>=0&&o.bottom>i&&o.top>=i?(p=null,v=null,g=!1):o.top>=0&&o.bottom>i&&o.top<i?(p=0,v=i-o.top,g=!0):o.top<0&&o.bottom>i?(v=(p=-1*o.top)+i,g=!0):o.top>=0&&o.bottom<=i?(p=0,v=l,g=!0):o.top<0&&o.bottom>=0&&o.bottom<=i?(p=l+o.top,v=l,g=!0):o.top<0&&o.bottom<0?(p=null,v=null,g=!1):g=!1,{dHeight:r,dIsVisible:a,dVisibleTop:d,dVisibleBottom:c,dScrollUntil:m,dScrollRate:f,tHeight:l,tVisibleTop:p,tVisibleBottom:v,tMarginTop:u,tMarginBottom:s,tScrollUntil:v,tScrollRate:v/l,tViewableRate:(v-p)/l,tIsInView:g,tLength:n}}},{key:"queryMatch",value:function(e,t){var n,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"data-trackable",i="button",r=[];for(3===t.nodeType&&(t=t.parentNode);t&&t!==window.parent.document;){var a=(t.matches||t.msMatchesSelector||function(){return!1}).bind(t);t.hasAttribute(o)&&r.unshift(t.getAttribute(o)),!n&&a(e)&&(i="a"===t.tagName.toLowerCase()?"link":t.tagName.toLowerCase(),n=t),t=t.parentNode}return!!(n&&r.length>0)&&{element:n,category:i,path:r.join(">")}}}])&&c(t.prototype,n),o&&c(t,o),e}();function u(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}var s,m,f,p,v,g=new Date,w={media:[]},y=new Date,b=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,o;return t=e,(n=[{key:"init",value:function(e){s=e,v=new l,m=s.targetWindow||"self",f=s.tdNs||"td",window[m][f].set("$global","root_id",v.generateId()),s.eventName&&s.eventFrequency&&void 0===p&&(p=new a({eventName:s.eventName,eventFrequency:s.eventFrequency,targetWindow:m})),"performance"in window[m]&&("interactive"===window[m].document.readyState||"complete"===window[m].document.readyState?this.trackAction("rum","page",{}):this.trackPerformance(m)),s.options&&s.options.unload&&s.options.unload.enable&&this.trackUnload(),s.options&&s.options.scroll&&s.options.scroll.enable&&this.trackScroll(),s.options&&s.options.read&&s.options.read.enable&&this.trackRead(s.options.read.target),s.options&&s.options.clicks&&s.options.clicks.enable&&this.trackClicks(),s.options&&s.options.media&&s.options.media.enable&&this.trackMedia()}},{key:"trackAction",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"unknown",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"unknown",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o=new Date,i={action:e,category:t,since_init_ms:o.getTime()-g.getTime(),since_prev_ms:o.getTime()-y.getTime()},r=v.mergeObj([i,n,v.getPerformanceInfo()]);y=o,window[m][f].trackEvent(s.table,r)}},{key:"trackPageview",value:function(){this.trackAction("view","page")}},{key:"trackPerformance",value:function(){var e=this;p.removeListener(w.performance),w.performance=p.addListener(window[m].document,"DOMContentLoaded",function(){e.trackAction("rum","page",{})},!1)}},{key:"trackUnload",value:function(){var e,t=this;e="onbeforeunload"in window[m]?"beforeunload":"onpagehide"in window[m]?"pagehide":"unload",p.removeListener(w.unload),w.unload=p.addListener(window[m],e,function(){t.trackAction("unload","page",{})},!1)}},{key:"trackClicks",value:function(){var e=this;p.removeListener(w.click),w.click=p.addListener(window[m].document.body,"click",function(t){var n=s.options.clicks.targetAttr||"data-trackable",o=v.queryMatch('a, button, input, [role="button"]',t.target,n),i=null;o&&(i=o.element,e.trackAction("click",o.category,{click_tag:i.tagName,click_id:i.id||void 0,click_class:i.className||void 0,click_path:o.path||void 0,click_link:i.href||void 0,click_text:i.innerText||i.value||void 0,click_attr:i.dataset?JSON.stringify(i.dataset):void 0}))},!1)}},{key:"trackScroll",value:function(){var e=this,t=s.options.scroll.granularity||20,n=100/t,o=1e3*s.options.scroll.threshold||2e3,i={},r=0,a=0,d="percent";p.removeListener(w.scroll),w.scroll=p.addListener(window[m],s.eventName,function(){"hidden"!==(i=v.getVisibility(null,m)).dIsVisible&&"prerender"!==i.dIsVisible&&("percent"===s.options.scroll.unit?r=Math.floor(i.dScrollRate*n)*t:(r=i.dScrollUntil,d="pixel"),("percent"===d&&r>a&&r>=0&&r<=100||"pixel"===d&&r>a&&r>=t)&&setTimeout(function(){r>a&&(e.trackAction("scroll","page",{page_height:i.dHeight,scroll_depth:r,scroll_unit:d}),a="percent"===d?r:r+t)},o))},!1)}},{key:"trackRead",value:function(e){var t=this;if(e){var n,o,i,r=s.options.read.granularity||20,a=100/r,d=1e3*s.options.read.threshold||2e3;p.removeListener(w.read),w.read=p.addListener(window[m],s.eventName,function(){o=o||0,i=i||0,"hidden"!==(n=v.getVisibility(e,m)).dIsVisible&&"prerender"!==n.dIsVisible&&n.tIsInView&&(o=Math.floor(n.tScrollRate*a)*r)>i&&o>=0&&o<=100&&setTimeout(function(){o>i&&e&&(t.trackAction("read","content",{read_id:e.id||void 0,read_start_with:e.innerText.substring(0,12)||void 0,read_target_height:n.tHeight,read_text_length:n.tLength,read_rate:o,read_attr:e.dataset?JSON.stringify(e.dataset):void 0}),i=o)},d)},!1)}}},{key:"trackMedia",value:function(){for(var e=this,t=["play","pause","ended"],n=s.options.media.heartbeat||5,o={},i=0;i<t.length;i++)p.removeListener(w.media[t[i]]),w.media[t[i]]=p.addListener(window[m].document.body,t[i],function(t){e.trackAction(t.type,t.target.tagName.toLowerCase(),v.getMediaInfo(t.target))},{capture:!0});p.removeListener(w.media.timeupdate),w.media.timeupdate=p.addListener(window[m].document,"timeupdate",function(t){if(o[t.target.src])return!1;o[t.target.src]=setTimeout(function(){!0!==t.target.paused&&!0!==t.target.ended&&e.trackAction(t.type,t.target.tagName.toLowerCase(),v.getMediaInfo(t.target)),o[t.target.src]=!1},1e3*n)},{capture:!0})}}])&&u(t.prototype,n),o&&u(t,o),e}();window.tdext=new b}]);